{
    "version": "https://jsonfeed.org/version/1",
    "title": "yongliang的博客 • All posts by \"recoil\" category",
    "description": "",
    "home_page_url": "https://blog.niuniu.club",
    "items": [
        {
            "id": "https://blog.niuniu.club/2020/12/25/react/state/recoil/React%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86%E4%B9%8BRecoil/",
            "url": "https://blog.niuniu.club/2020/12/25/react/state/recoil/React%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86%E4%B9%8BRecoil/",
            "title": "React状态管理之Recoil",
            "date_published": "2020-12-25T03:26:37.000Z",
            "content_html": "<h1 id=\"Recoil学习笔记\"><a href=\"#Recoil学习笔记\" class=\"headerlink\" title=\"Recoil学习笔记\"></a>Recoil学习笔记</h1><h2 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h2><h3 id=\"npm\"><a href=\"#npm\" class=\"headerlink\" title=\"npm\"></a>npm</h3>  <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install recoil</span><br></pre></td></tr></table></figure>\n<p>  or<br>  <figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yarn add recoil</span><br></pre></td></tr></table></figure></p>\n<h2 id=\"使用\"><a href=\"#使用\" class=\"headerlink\" title=\"使用\"></a>使用</h2><h3 id=\"定义数据-atom\"><a href=\"#定义数据-atom\" class=\"headerlink\" title=\"定义数据 atom:\"></a>定义数据 atom:</h3><p>  atom 可以在任何地方定义状态数据<br>  <figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> todoListState = atom(&#123;</span><br><span class=\"line\">  key: <span class=\"string\">&#x27;todoListState&#x27;</span>,</span><br><span class=\"line\">  <span class=\"keyword\">default</span>: [],</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure><br>  在需要的地方，可以使用useRecoilValue() hook读取我们定义的数据<br>  <figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">TodoList</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> todoList = useRecoilValue(todoListState);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">return</span> (</span><br><span class=\"line\">    &lt;&gt;</span><br><span class=\"line\">      &#123; <span class=\"regexp\">/ * &lt;TodoListStats /</span>&gt; * / &#125;</span><br><span class=\"line\">      &#123; <span class=\"regexp\">/ * &lt;TodoListFilters /</span>&gt; * / &#125;</span><br><span class=\"line\">      &lt; TodoItemCreator /&gt;</span><br><span class=\"line\">      &#123;todoList.map(<span class=\"function\">(<span class=\"params\">todoItem</span>) =&gt;</span> (</span><br><span class=\"line\">        &lt;TodoItem key=&#123;todoItem.id&#125; item=&#123;todoItem&#125; /&gt;</span><br><span class=\"line\">      ))&#125;</span><br><span class=\"line\">    &lt;/&gt;</span><br><span class=\"line\">  )</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><br>  可以使用useSetRecoilValue() hook设置我们定义的数据<br>  <figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">TodoItemCreator</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> [inputValue, setInputValue] = useState(<span class=\"string\">&#x27;&#x27;</span>)</span><br><span class=\"line\">  <span class=\"keyword\">const</span> setTodoList = useSetRecoilValue(todoListState);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">const</span> addItem = <span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">    setTodoList(<span class=\"function\">(<span class=\"params\">oldTodoList</span>) =&gt;</span> [</span><br><span class=\"line\">      ...oldTodoList,</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        id: getId(),</span><br><span class=\"line\">        text: inputValue(),</span><br><span class=\"line\">        isComplete: <span class=\"literal\">false</span>,</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    ]);</span><br><span class=\"line\">    setInputValue(<span class=\"string\">&#x27;&#x27;</span>);</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">const</span> onChange = <span class=\"function\">(<span class=\"params\">&#123;target: &#123;value&#125;&#125;</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    setInputValue(value);</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">return</span> (</span><br><span class=\"line\">    &lt;div&gt;</span><br><span class=\"line\">      &lt;input type=<span class=\"string\">&quot;text&quot;</span> value=&#123;inputValue&#125; onChange=&#123;onChange&#125; /&gt;</span><br><span class=\"line\">      &lt;button onClick=&#123;addItem&#125;&gt;Add&lt;/button&gt;</span><br><span class=\"line\">    &lt;/div&gt;</span><br><span class=\"line\">  );</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 获取唯一id</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> id = <span class=\"number\">0</span>;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getId</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> id++;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n",
            "tags": []
        }
    ]
}